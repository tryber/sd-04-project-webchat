<!-- <!DOCTYPE html>
<html lang="en">
  <script src="/socket.io/socket.io.js"></script>
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script src="http://chancejs.com/chance.min.js"></script>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1"
      crossorigin="anonymous"
    />
    <title>webChat</title>
  </head>
  <body>
    <div class="container">
      <div class="container">
        <ul style="list-style-type: none" id="listOfNames"></ul>
      </div>

      <div class="container">
        <h1>webChat</h1>
        <div id="chat"></div>
        <br />
        <label for="nameInput">Name</label>
        <input
          class="form-control"
          name="nameInput"
          type="text"
          data-testid="nickname-box"
          id="userName"
        />
        <br />
        <button class="btn btn-primary" 
        data-testid="nickname-save"
        onclick="saveName()">Save</button>
        <br />
        <br />

        <input
          type="text"
          class="form-control form-control-lg"
          data-testid="message-box"
          id="messageInput"
        />
        <br />
        <button
          class="btn btn-outline-success"
          id="sendButton"
          data-testid="send-button"
          onclick="sendMessage()"
        >
          Enviar
        </button>
        <hr />
        <br />
      </div>
    </div>
  </body>
  <script>
    var socket = io('http://localhost:3000/');
    var namesList = [];
    const nameUser = document.getElementById('userName');

    socket.on('disconnect', () => {
      console.log('Desconectado :(');
    });

    socket.on('historic', (data) => {
      let chat = document.getElementById('chat');
      let msgLine = document.createElement('p');
      msgLine.setAttribute('data-testid', 'message');
      msgLine.setAttribute(
        'class',
        'border border-info border-5 border-end-0 rounded-start'
      );
      msgLine.innerHTML = data;

      chat.append(msgLine);
    });

    const makeListOfName = (name) => {
      const itemName = document.createElement('li');
      itemName.innerHTML = name;
      const listOfNames = document.getElementById('listOfNames');
      listOfNames.appendChild(itemName);
    };

    const showAlert = () => {
      alert('Este nome já existe');
    };

    const verifyName = (name) => {
      let testResult = namesList.filter((item) => {
        if (item === name) {
          alert('esse nome já existe');
          return true;
        }
        return false;
      });
      return testResult;
    };

    const saveName = () => {
      let realName = nameUser.value;
      const nameOnce = verifyName(realName);
      console.log(nameOnce);

      if (nameOnce.length < 1) {
        namesList.push(realName);

        makeListOfName(realName);
      }
      return null;
    };

    const sendMessage = () => {
      //console.log('entrou aqui no sendMessage');
      let inputMsg = document.getElementById('messageInput');

      const chatMessage = inputMsg.value;
      const nickname = nameUser.value;

      socket.emit('message', { chatMessage, nickname });
    };
  </script>
</html>
 -->